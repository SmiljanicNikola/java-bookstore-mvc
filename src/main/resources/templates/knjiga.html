<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<base href="/KnjizaraProjekat/">
	<meta charset="UTF-8">
	<title>Pojedinacna knjiga</title>
	<link rel="stylesheet" type="text/css" href="css/TabelaKnjiga.css"/>
</head>

<body>

	<div th:insert="navbar :: navbar">...</div>

	<form method="post" action="Knjige/Edit" th:if="${session.prijavljeniKorisnik != null}">
		<table border="1">
			<caption th:text="#{knjiga.pageTitle}"></caption>
			<tr><th>Id</th><td><input type="number" th:value="${knjiga.id}" name="id"/></td></tr>
			<tr><th th:text="#{knjiga.naziv}"></th><td><input type="text" th:value="${knjiga.naziv}" name="naziv"/></td></tr>
			<tr><th>Isbn:</th><td><input type="number" th:value="${knjiga.isbn}" name="isbn"></td></tr>
			<tr><th th:text="#{knjiga.izdavackaKuca}"></th><td><input type="text" th:value="${knjiga.izdavackaKuca}" name="izdavackaKuca"/></td></tr>
			<tr><th th:text="#{knjiga.autor}"></th><td><input type="text" th:value="${knjiga.autor}" name="autor"/></td></tr>
			<tr><th th:text="#{knjiga.godinaIzdavanja}"></th><td><input type="date" th:value="${#temporals.format(knjiga.godinaIzdavanja, 'yyyy-MM-dd')}" name="godinaIzdavanja"/></td></tr>		
			<tr><th th:text="#{knjiga.kratakOpis}"></th><td><input type="text" th:value="${knjiga.kratakOpis}" name="kratakOpis"/></td></tr>
			<tr><th th:text="#{knjiga.cena}"></th><td><input type="number" th:value="${knjiga.cena}" name="cena"/></td></tr>
			<tr><th th:text="#{knjiga.brojStranica}"></th><td><input type="number" th:value="${knjiga.brojStranica}" name="brojStranica"/></td></tr>
			<tr><th th:text="#{knjiga.tipPoveza}"></th><td><input type="text" th:value="${knjiga.tipPoveza}" name="tipPoveza"/></td></tr>
			<tr><th th:text="#{knjiga.pismo}"></th><td><input type="text" th:value="${knjiga.pismo}" name="pismo"/></td></tr>
			<tr><th th:text="#{knjiga.jezik}"></th><td><input type="text" th:value="${knjiga.jezik}" name="jezik"/></td></tr>
			<tr><th th:text="#{knjiga.prosecnaOcena}"></th><td><input type="number" th:value="${knjiga.prosecnaOcena}" name="prosecnaOcena"/></td></tr>
			
			<tr th:if="${session.prijavljeniKorisnik != null and session.prijavljeniKorisnik.uloga == 'administrator'}"><th></th><td><input type="submit" value="Izmeni"/></td></tr>
		</table>
	</form>
			<table th:if="${session.prijavljeniKorisnik != null and session.prijavljeniKorisnik.uloga == 'administrator'}">
				<tr>
					<td>
						<ul>
							<li>
								Broj preostalih primeraka:<input type="number" th:value="${knjiga.brojPrimeraka}" name="brojPrimeraka"/><br>		
								<h3 th:text="#{knjiga.naruciKnjige}"></h3>	
								<form method="post" action="Knjige/Poruci"> 
									<input type="hidden" th:value="${knjiga.id}" name="id"/>
									<input type="number" name="brojPrimeraka">		
									<button type="submit" th:text="#{knjiga.naruci}"></button>
								</form>
							</li>
						</ul>
					</td>
				</tr>
			</table>
			
			
			<ul>
				<li><a href="DodavanjeKomentara" th:text="#{knjiga.ostaviKomentar}" ></a></li>
				<li><a href="KorisnickaKorpa" th:text="#{Pregledaj korisnicku korpu}" ></a></li>
			</ul>
			
			<form method="post" action="Delete">
				<input type="hidden" name="id" th:value="${knjiga.id}"/>
				<table>
					<tr><td><input type="submit" value="ObriÅ¡i knjigu"/></td></tr>
				</table>
			</form>	
			
			<form method="post" action="KorisnickaKorpa/Create">
				<input type="hidden" name="knjigaId" th:value="${knjiga.id}"/>
				<div class="Udesno">
					<table>
						<tr><th>Unesite zeljenu kolicinu</th><td><input type="number" name="kolicina"/><input type="submit" value="Dodaj u korpu"/></td></tr>	
					</table>
				</div>
			</form>
			
			<form method="post" action="ListaZelja/Create">
				<input type="hidden" name="knjigaId" th:value="${knjiga.id}"/>
				<table>
					<tr><td><input type="submit" value="Dodaj u listu zelja"/></td></tr>
				</table>
			</form>		
			
	<form method="get">
			<table class="tabela" border="1" >
			<caption>Komentari</caption>
			<tr>
				<th>Id</th>
				<th>Tekst Komentara</th>
				<th>Ocena</th>
				<th>Datum Postavljanja</th>
				<th>Autor</th>
				<th>Knjiga za koju je vezan</th>
				<th>Status</th>
			</tr>
			<tr th:each="komentar, status: ${komentari}" th:if="${komentar.status == 'Odobren' and komentar.knjiga.naziv == knjiga.naziv}">
				<td>
					<a th:href="|Komentari/Details?id=${komentar.id}|"th:text="${komentar.id}"></a>
				</td>
				<td th:text="${komentar.tekstKomentara}"></td>
				<td class="broj" th:text="${komentar.ocena}"></td>
				<td th:text="${komentar.datumPostavljanja}"></td>
				<td th:text="${komentar.autor.korisnickoIme}"></td>
				<td th:text="${komentar.knjiga.naziv}"></td>
				<td th:text="${komentar.status}"></td>
			</tr>
			
		</table>
	</form>
				
</body>
</html>